# DeepSeek API 集成与Excel模板使用指南

本工具直接使用或修改、整合了如下网友的代码，他们的工作非常精彩，在此表示感谢：
**AI博士嗨嗨**、**Sven Bosau**、**ExcelHome 周庆麟**、**Excel AI之家 小意**。

**首先**，为了让xlsm文件正常使用，你需要 开启 **启用所有宏 (不建议启用，潜在危险代码可以运行)** 和 **信任对 VBA 工程对象模型的访问** 。按如下操作:

  1."文件"→"选项" →"信任中心"→"信任中心设置"→点选"启用所有宏 (不建议启用，潜在危险代码可以运行)"。
  
  2.在同一个操作界面中也点选上"信任对 VBA 工程对象模型的访问"
**然后：**
## 🗝️ 第一步：API密钥配置步骤
1. 获取DeepSeek官方API Key
2. 打开工作簿中的`API_INFO`工作表
3. 将密钥粘贴至`B2`单元格
4. 完成配置即可调用AI服务

## 📊 第二步：DATA工作表用法

### 🤖 2.1 AI_CHAT基础功能
- **函数调用**：使用`AI_CHAT()`函数直接提问
- **返回特性**：支持长文本结构化输出

### 🖱️ 2.2 对话窗口操作
- **启动方式**：
  - 点击AI_NIUMA按钮
  - 快捷键 `Ctrl+Alt+K`

   #### 2.2.1 三种智能模式对比

| 模式名称    | 功能特性                                      | 典型应用场景                 |
|------------|---------------------------------------------|----------------------------|
| **执行模式** | • 实时生成VBA代码<br>• 自动执行操作           | 格式调整、批量处理           |
| **分析家模式** | • 商务数据分析<br>• 统计建模建议             | 数据解读、趋势预测、不会操作工作表           |
| **超级模式**  | • 综合数据分析<br>• VBA代码生成与执行<br>• 智能建议 | 自动化报告生成、复杂任务处理 |

  ### ⚡ 模式特性详解
  1. **执行模式**
   - 直接指令示例：_"将K列字体调整为14号"_
   - 实现过程：AI → VBA代码 → 自动执行

  2. **分析家模式**
   - 输出内容：
     - 多维度数据分析
     - 统计模型建议
     - 可视化方案推荐

  3. **超级模式**
   - 复合型输出：
     - 数据分析报告
     - 自动化VBA脚本
     - 智能优化建议
   - 执行流程：分析 → 代码生成 → 自动实施
